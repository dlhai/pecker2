<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>啄木鸟风电维保系统</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="stylesheet" href="css/bootstrap.css" />
    <script src="js/jquery.js"></script>
    <script src="js/bootstrap.js"></script>
    <script type="text/javascript" src="js/doTe.js"></script>
    <script src="laydate/laydate.js"></script>
    <script src="js/utils.js"></script>
    <link rel="stylesheet" href="css/xpecker.css" />
    <script src="js/Cube.js"></script>
    <script src="js/db.js"></script>
    <script src="js/xpecker.js"></script>

    <style>
        html, body {height: 100%;overflow: hidden;}
        .xrAngle {border-radius: 4px;border: 1px solid #dddddd;}
        .xScroll {width: 100%;height: 100%;overflow-y: scroll;overflow-x: scroll;}
        .xPanel {border-radius: 4px;border: 1px solid #dddddd;margin:10px; height:300px;}
        .xPanel .xLHead {width: 28px;height: 100%;padding: 6px;background: #f5f5f5;border-right: 1px solid #dddddd;}
        .xFc_srow {display: flex;flex-direction: row;align-items: stretch;align-content: stretch;}
        .xFc_scol {display: flex;flex-direction: column;align-items: stretch;align-content: stretch;}
        .xFi_fixed{flex-shrink: 0;flex-grow: 0;}
        .xFi_grow {flex-grow: 1;}

        .card {
            display: inline-block;
            margin: 10px;
            width: 230px;
            box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19);
            text-align: center;
            border-radius: 5px;
        }
        .card .header {
            border-radius: 5px 5px 0px 0px;
            background-color: #98bf68;
            color: white;
            font-size: 10px;
            height: 42px;
            text-align: center;
            overflow: hidden;
        }
        .card .header .type {
            border-radius: 5px 0px 5px 0px;
            color: white;
            font-size: 12px;
            float: left;
            border: 1px solid #6a923d;
        }
        .card .header .title {
            color: white;
            padding-top: 8px;
            font-size: 20px;
            text-align: center;
            width: 100%;
        }
        .card .header .sent {
            padding-top: 15px;
            padding-right: 4px;
            text-align: right;
            font-size: 12px;
            float: right;
        }
        .card .header .sent .time {
            padding: 0px 2px;
            top: -4px;
            left: 5px;
            text-align: right;
            position: relative;
        }
        .card .body {
                background-color: #f5f3ee;
                color: #5f5135;
                padding: 4px;
                font-size: 14px;
                text-align: center;
                border-top: 1px solid #6a923d;
                border-bottom: 1px solid #e0d5c5;
            }
        .card .foot {
            background-color: #f0ece2;
            border-radius: 0px 0px 5px 5px;
            height: 45px;
        }
        .card button {
            background: linear-gradient(#d2e7b9, #6fa743);
            border: 1px solid #cfc4b6;
            color: white;
            padding: 4px 16px;
            text-align: center;
            text-decoration: none;
            display: inline-block;
            font-size: 14px;
            margin: 6px;
            cursor: pointer;
            border-radius: 6px;
            box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.2), 0 2px 5px 0 rgba(0, 0, 0, 0.19);
        }

        .card table {width: 100%;table-layout: fixed;}
        .card table tr:nth-child(2n+1) {background-color: #ffffee;}
        .card table tr:nth-child(2n) {background-color: #eeffee;}
       /* .card table tr:first-child {width: 200px;text-align: left;}*/
        .card table td, .card table th {white-space: nowrap;overflow: hidden;word-break: keep-all;}
    </style>
</head>
<body class="xFCsrow">
    <div id="curitem" class="xFCscol xFIfixed" style="width: 300px;">
        <section class="xPanel2">
            <header>正在编辑<div style="float: right;"><a href="javascript:onNewProv()">新建</a></div></header>
            <div id="g_matins_editing" class="xScroll" style="padding: 5px;height:100px;flex-grow: 1;"></div>
        </section>
        <section class="xPanel2">
            <header>等待审批</header>
            <div id="g_matins_checking" class="xScroll" style="padding:5px;height:100px;flex-grow: 1;"></div>
        </section>
    </div>
    <section class="xPanel2">
        <header>当前单据</header>
        <div style="padding: 5px;height:100px;flex-grow: 1;"></div>
    </section>
    <section class="xPanel2  xFIfixed" style="width: 300px;">
        <header>等待入库</header>
        <div id="g_matins_whin" class="xScroll" style="padding: 5px;height:100px;flex-grow: 1;"></div>
    </section>


    <script id="tpl_matin" type="text/template">
        {% for (var i=0,x=it[0];i<it.length;i++,x=it[i]) { %}
        <div class="card">
            <div class="header">
                <div class="type">{%=x.type%}</div>
                <div class="sent">
                    <div>{%=x.deliver%}</div>
                    <div class="time">{%=x.deliverdt%}</div>
                </div>
                <div class="title">{%=x.way%}</div>
            </div>
            <div class="body">
                <table cellpadding="2px">
                    {% for (var j=0,y=x.subs[0];j<x.subs.length;j++,y=it[j]) { %}
                    <tr><td style="width: 140px; text-align: left;">{%=y.name%}</td><td>{%=y.count%}</td><td>{%=y.unit%}</td></tr>
                    {% } %}
                </table>
            </div>
        </div>
        {% } %}
    </script>

    <script type="text/javascript">
        var g_user = parent.g_user, g_matins, g_matins_editing = new Array(), g_matins_checking = new Array(), g_matins_whin = new Array();
        if (g_user == undefined)
            g_user = GetRoleUser("仓库主管");

        Reqdata("/rdmatins?user_id=" + g_user.id, "", function (matins) {
            g_matins = matins;
            for (var i in matins.mdata) {
                var mdata = matins.mdata[i];
                mdata.subs = new Array();
                mdata.type = "入库单";
                for (var j in matins.rdata) {
                    if (mdata.id == matins.rdata[j].matin_id)
                        mdata.subs.push(matins.rdata[j]);
                }
                if (mdata.status == 0 || mdata.status == -1) g_matins_editing.push(mdata);
                else if (mdata.status == 1) g_matins_checking.push(mdata);
                else if (mdata.status == 2) g_matins_whin.push(mdata);
            }
            var tpl_matin = doT.template(document.getElementById('tpl_matin').innerHTML);
            $("#g_matins_editing").html(tpl_matin(g_matins_editing));
            $("#g_matins_checking").html(tpl_matin(g_matins_checking));
            $("#g_matins_whin").html(tpl_matin(g_matins_whin));
        });

        // 表单验证的几种方法： http://www.jb51.net/article/92741.htm
    </script>
</body>
</html>

